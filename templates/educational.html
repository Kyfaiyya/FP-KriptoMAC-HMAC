{% extends "base.html" %}

{% block title %}Learn about MAC & HMAC - A Deep Dive{% endblock %}
{% block meta_description %}Understand the concepts of Message Authentication Code (MAC) and HMAC, including formulas,
security considerations, and real-world use cases.{% endblock %}

{% block content %}
<div class="row educational-page">
  <div class="col-12">
    <div class="p-4 mb-4 bg-light rounded-3">
      <h1 class="display-5"><i class="fas fa-graduation-cap me-2" aria-hidden="true"></i> Learning Center: MAC & HMAC
      </h1>
      <p class="lead">A comprehensive guide to understanding Message Authentication Codes.</p>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-8">
    <div class="card mb-4">
      <div class="card-header">
        <h2><i class="fas fa-info-circle me-2" aria-hidden="true"></i>What is a MAC?</h2>
      </div>
      <div class="card-body">
        <p>
          A <strong>Message Authentication Code (MAC)</strong> is a short piece of information used to authenticate a
          message—in other words, to confirm that the message came from the stated sender (its authenticity) and has not
          been changed (its integrity).
        </p>
        <h3>Key Functions of a MAC:</h3>
        <ul>
          <li><strong>Authentication:</strong> Verifies that the message originates from a legitimate sender who knows
            the secret key.</li>
          <li><strong>Integrity:</strong> Ensures the message was not altered during transmission.</li>
          <li><strong>Non-repudiation:</strong> The sender cannot deny having sent the message, as only they have the
            secret key.</li>
        </ul>
        <h3>How a MAC Works:</h3>
        <ol>
          <li>The sender calculates a MAC value from the message and a shared secret key.</li>
          <li>The original message and the MAC value are sent to the receiver.</li>
          <li>The receiver recalculates the MAC using the same message and the shared secret key.</li>
          <li>If the calculated MAC matches the received MAC, the message is considered authentic and untampered.</li>
        </ol>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h2><i class="fas fa-shield-alt me-2" aria-hidden="true"></i>What is HMAC?</h2>
      </div>
      <div class="card-body">
        <p>
          <strong>Hash-based Message Authentication Code (HMAC)</strong> is a specific type of MAC involving a
          cryptographic hash function (like SHA-256) and a secret cryptographic key. It is the most common and
          recommended type of MAC.
        </p>
        <h3>HMAC Formula:</h3>
        <div class="alert alert-light">
          <code>HMAC(K, m) = H((K ⊕ opad) || H((K ⊕ ipad) || m))</code>
        </div>
        <h3>Advantages of HMAC:</h3>
        <ul>
          <li>Resistant to length extension attacks, a vulnerability in simpler MAC constructions.</li>
          <li>Built upon well-tested and widely available hash functions.</li>
          <li>An industry standard defined in RFC 2104.</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card mb-4">
      <div class="card-header">
        <h3><i class="fas fa-exclamation-triangle me-2" aria-hidden="true"></i>Security Considerations</h3>
      </div>
      <div class="card-body">
        <h4>Key Management</h4>
        <ul>
          <li>Use long, random keys (at least 128 bits).</li>
          <li>Never hardcode keys in source code.</li>
          <li>Rotate keys periodically.</li>
        </ul>
        <h4>Algorithm Choice</h4>
        <ul>
          <li><span class="badge bg-success">Recommended:</span> SHA-256, SHA-512</li>
          <li><span class="badge bg-warning">Deprecated:</span> SHA-1</li>
          <li><span class="badge bg-danger">Broken:</span> MD5</li>
        </ul>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-header">
        <h3><i class="fas fa-lightbulb me-2" aria-hidden="true"></i>Common Use Cases</h3>
      </div>
      <div class="card-body">
        <ul>
          <li><strong>API Authentication:</strong> Verifying requests between services.</li>
          <li><strong>File Integrity:</strong> Detecting if a downloaded file has been tampered with.</li>
          <li><strong>JSON Web Tokens (JWT):</strong> Securing the signature part of a JWT.</li>
          <li><strong>Secure Cookies:</strong> Protecting session cookies from being modified.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
{% endblock %}